<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Example-Driven Development</title>

    <!-- browser setup -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">

    <!-- page meta information -->
    <meta name="description" content="Example-Driven Development is superficially like Test-Driven Development, where you drive development by constructing test methods that return example objects. It sounds simple, but it actually changes the development process in several fundamental ways.">
    <meta property="og:type" content="article">
    <meta property="og:site_name" content="gtoolkit book">
    <meta property="og:title" content="Example-Driven Development">
    <meta property="og:url" content="https://book.gtoolkit.com/index.html">
    <meta property="og:description" content="Example-Driven Development is superficially like Test-Driven Development, where you drive development by constructing test methods that return example objects. It sounds simple, but it actually changes the development process in several fundamental ways.">

    <!-- CSS styles -->
    <link rel="stylesheet"  href="../assets/vendor/awesomefonts/css/all.css">
    <link rel="stylesheet"  href="../assets/vendor/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet"  href="../assets/v1/src/css/lepiter-common.css">
    <link rel="stylesheet"  href="../assets/v1/src/css/lepiter-snippets.css">
    <link rel="stylesheet"  href="../assets/v1/src/css/vs.css">
</head>
<body>

    <div class="content">
        <div class="container min-height py-5 le-main-container">
            <main>
                <h1 class="le-main-title">Example-Driven Development</h1>

                <!-- page content start -->

                <div class="snippet textual-snippet text-snippet paragraphWidth"></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <h2> What is EDD?  </h2></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>Example-Driven Development is superficially like Test-Driven Development, where you drive development by constructing test methods that return example objects. It sounds simple, but it actually changes the development process in several fundamental ways.  </p></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <h2> The Trouble with TDD  </h2></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>With TDD, you develop code by incrementally adding a test for a new feature, which fails. Then you write the “simplest code” that passes the new test. You add new tests, refactoring as needed, until you have fully covered everything that the new feature should fulfil, as specified by the tests.  </p></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>But:     <i>Where do tests come from?    </i> When you write a test, you actually have to “guess first” to imagine what objects to create, exercise and test.  </p></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>    <i>How do we write the simplest code that passes?    </i> A test that fails gives you a debugger context, but then you have to go somewhere else to add some new classes and methods.  </p></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>    <i>What use is a green test?    </i> Green tests can be used to detect regressions, but otherwise they don't help you much to create new tests or explore the running system.  </p></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>With Example-Driven Development we try to answer these questions.  </p></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <h2> What's an Example?  </h2></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>An     <i>example method    </i> is just a test method that happens to return the object being tested. Through this simple change, instead of a passing test simply being green, we get back an     <i>object    </i> that we can inspect, explore, and reuse for various purposes.  </p></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>Here we see a simple example of an example method for a “Memory” game. It is annotated with a <code>&lt;gtExample></code> pragma to flag it as an example.  </p></div><figure class="snippet picture-snippet fullWidth"><img class="picture-snippet-image" src="gt-figures/1000.png"/></figure><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>Like any test, it has a setup, which in this case creates a <code>game</code> object. We check some assertions, in this case perform no further operations, and then we return the object under test.  </p></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>This allows us not only to carry out the tests, but also to inspect the result. Here we see a screenshot of the     <i>Live    </i> GUI view of the memory game instance.  </p></div><div>  <figure class="snippet picture-snippet fullWidth"><img class="picture-snippet-image" src="gt-figures/1001.png"/>  </figure></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <h2> Composing examples  </h2></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>Once we have an example, we can also use it as a setup for another example.<code>chooseMatchingPair</code> is another example method that starts with <code>fixedGame</code> as its setup.  </p></div><figure class="snippet picture-snippet fullWidth"><img class="picture-snippet-image" src="gt-figures/1002.png"/></figure><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>As in a conventional test, we can check some preconditions, perform one or more operations, and then check some postconditions. The difference, again, is that we return the object under test, so we can explore it.   </p></div><div>  <figure class="snippet picture-snippet fullWidth"><img class="picture-snippet-image" src="gt-figures/1003.png"/>  </figure></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>We can also reuse it as a setup for yet another example, in this case, <code>playToEnd</code>.  </p></div><figure class="snippet picture-snippet fullWidth"><img class="picture-snippet-image" src="gt-figures/1004.png"/></figure><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>If we switch to the     <i>Examples map    </i> view, we can see all the dependencies between the examples.  </p></div><figure class="snippet picture-snippet fullWidth"><img class="picture-snippet-image" src="gt-figures/1005.png"/><figcaption class="picture-snippet-caption">An Example  map for the memory game</figcaption></figure><div class="snippet textual-snippet text-snippet paragraphWidth">  <h2> What are example methods good for?  </h2></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>As we have seen, examples make dependencies between tests explicit by reusing examples as setups for other examples, thus forming a hierarchy of examples.  </p></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>• Example composition reduces:  </p></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>—     <i>code duplication,    </i>  </p></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>—     <i>cascading failures.    </i>  </p></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>• Examples can be reused in     <i>live documentation.    </i>  </p></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>• EDD is an     <i>exploratory approach    </i> to TDD.  </p></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>Best practice in test design supposedly should avoid dependencies between tests, but <a href="https://scg.unibe.ch/assets/scgbib/?query=Haen09a">studies</a> have shown that this practice instead leads to implicit dependencies due to duplicated code in test setups. This in turn leads to cascading failures due to the same setups being repeated in numerous tests. By factoring out the commonalities as examples, the duplication is removed, and cascading failures are avoided.  </p></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>A further benefit is that examples can be used in live documentation, and, as we shall see, examples support an exploratory approach to test-driven development, that we call example-driven development, or EDD.  </p></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <h2> Modeling prices  </h2></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>Let's work through an example where we want to model     <i>prices    </i> for goods, that may be     <i>discounted    </i> by fixed amounts, or percentages, or even combinations of different types of discounts.  </p></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>    <i>A price can be something like 100 EUR.    </i>    <i>Prices can be added or multiplied.    </i>    <i>A price can also be discounted either by a fixed amount of money, or by a percentage.    </i>    <i>All operations can be combined arbitrarily.    </i>    <i>And for audit purposes, we want to track all operations that lead to a concrete amount of money.    </i>  </p></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <h2> Money classes  </h2></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>To simplify our task, we assume that we already have classes that model different amounts of money, such as 42 € or 10 USD.  </p></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>All these classes have a common abstract     <i>GtTMoney    </i> superclass for shared behavior.  </p></div><figure class="snippet picture-snippet fullWidth"><img class="picture-snippet-image" src="gt-figures/1006.png"/></figure><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>An amount of money is always in a     <i>currency    </i> such as euros or US dollars.A     <i>bag    </i> of money consists of amounts of mixed currencies.A     <i>zero    </i> amount of money doesn't have a currency.  </p></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>This expression:  </p></div><div class="snippet textual-snippet code-snippet pharo-snippet fullWidth">  <pre class="no_bottom_margin">42 euros.  </pre></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>yields:  </p></div><figure class="snippet picture-snippet fullWidth"><img class="picture-snippet-image" src="gt-figures/1007.png"/></figure><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>While:  </p></div><div class="snippet textual-snippet code-snippet pharo-snippet fullWidth">  <pre class="no_bottom_margin">42 euros + 10 usd.  </pre></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>yields:  </p></div><figure class="snippet picture-snippet fullWidth"><img class="picture-snippet-image" src="gt-figures/1008.png"/></figure><div class="snippet textual-snippet text-snippet paragraphWidth">  <h2> Money examples  </h2></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>The money classes are heavily covered by examples, which are essentially unit tests that also return example objects. For example, this method tests that adding a zero amount of a different currency won't accidentally create a bag of monies.  </p></div><figure class="snippet picture-snippet fullWidth"><img class="picture-snippet-image" src="gt-figures/1009.png"/></figure><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>A passing test is not just green, but also returns an object that can be explored, reused as a setup for another example, or embedded into live documentation. Unlike tests, however, examples don't come “first” but they are extracted during the example-driven development process.  </p></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <h2> Introducing a Concrete Price  </h2></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>Just like we have a hierarchy of Money classes, we expect to end up with a hierarchy of Price objects, including an abstract root class, a concrete, fixed price, and several kinds of discounted prices.Instead of designing this hierarchy up-front, we'll develop it incrementally, driven by examples.  </p></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>We'll start with an example of a concrete (as opposed to an abstract) Price object.  </p></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>    <i>A price can be something like 100 EUR.    </i>    <i>Prices can be added or multiplied.    </i>...  </p></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <h3> Start from an object  </h3></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>Instead of starting by imagining and writing a test case as an example method, we start by creating an instance of the class we need. We first simply ask how we want to create our concrete instance of a price, and we write that code in a snippet.  </p></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>Neither the class nor the constructor exist, so we create them as fixit operations. We start with a snippet to create an instance of the class we want to design.  </p></div><figure class="snippet picture-snippet fullWidth"><img class="picture-snippet-image" src="gt-figures/1010.png"/><figcaption class="picture-snippet-caption">A non-existing class with a fixit</figcaption></figure><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>The <code>ConcretePrice</code> class does not exist, so we see a     <i>fixit    </i> (wrench) icon. We click on it to generate the list of fixit options.  </p></div><figure class="snippet picture-snippet fullWidth"><img class="picture-snippet-image" src="gt-figures/1011.png"/><figcaption class="picture-snippet-caption">A fixit dialog</figcaption></figure><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>We fill in the form to create a new <code>ConcretePrice</code> class in the <code>EDDPrices</code> package, tag it as a <code>Model</code> class, and assign a <code>money</code> slot. We click the <code>Create</code> button to perform the fixit.  </p></div><figure class="snippet picture-snippet fullWidth"><img class="picture-snippet-image" src="gt-figures/1012.png"/><figcaption class="picture-snippet-caption">Creating a new class</figcaption></figure><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>We also generate accessors as a standard code transformation.  </p></div><figure class="snippet picture-snippet fullWidth"><img class="picture-snippet-image" src="gt-figures/1013.png"/><figcaption class="picture-snippet-caption">Creating accessors</figcaption></figure><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>Now we have a <code>ConcretePrice</code> instance to explore!  </p></div><figure class="snippet picture-snippet fullWidth"><img class="picture-snippet-image" src="gt-figures/1014.png"/><figcaption class="picture-snippet-caption">Inspecting a ConcretePrice instance</figcaption></figure><div class="snippet textual-snippet text-snippet paragraphWidth">  <h2> Create a factory method  </h2></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>We would  like to be able to create a price object by directly sending <code>asPrice</code> to a Money instance. We prototype this behavior in the playground of the <code>GtTCurrencyMoney</code> instance we have in front of us.  </p></div><figure class="snippet picture-snippet fullWidth"><img class="picture-snippet-image" src="gt-figures/1015.png"/><figcaption class="picture-snippet-caption">Prototyping the asPrice behavior</figcaption></figure><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>Now we can perform an     <i>Extract method    </i> refactoring on this code snippet, and change its category to be an     <i>extension method    </i> from our <code>EDDPrices</code> package.  </p></div><figure class="snippet picture-snippet fullWidth"><img class="picture-snippet-image" src="gt-figures/1016.png"/><figcaption class="picture-snippet-caption">Our code extracted as an extension method</figcaption></figure><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>And now we can simply write <code>100 euros asPrice</code>.  </p></div><figure class="snippet picture-snippet fullWidth"><img class="picture-snippet-image" src="gt-figures/1017.png"/><figcaption class="picture-snippet-caption">A factory method for prices</figcaption></figure><div class="snippet textual-snippet text-snippet paragraphWidth">  <h2> Adding a view  </h2></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>Our new Price object has only an ugly generic view, but its money slot has a nice  view we could reuse.  </p></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>We go to the <code>Meta</code> view of the Price object and add a new view method that forwards itself to the Details view of its <code>money</code> slot.  </p></div><figure class="snippet picture-snippet fullWidth"><img class="picture-snippet-image" src="gt-figures/1018.png"/><figcaption class="picture-snippet-caption">Defining a new view</figcaption></figure><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>A view is just a method that takes a view object as an argument, has a <code>&lt;gtView></code> pragma, and uses the view API to create the view we want, in this case a <code>forward</code> view. We set the title of the view to <code>Money</code>, and the priority to 10 so it appears early in the list of views. The object we want to forward to is the money slot, and the view is its <code>gtDisplayFor:</code> view.  </p></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>The moment we commit the view code, the view becomes available.  </p></div><figure class="snippet picture-snippet fullWidth"><img class="picture-snippet-image" src="gt-figures/1019.png"/><figcaption class="picture-snippet-caption">The Money view installed</figcaption></figure><div class="snippet textual-snippet text-snippet paragraphWidth">  <h2> Extracting an example  </h2></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>At this point it looks like we have a nice example for testing, so let's extract it as an example by applying an     <i>Extract example    </i> refactoring.  </p></div><div class="snippet textual-snippet text-snippet paragraphWidth"></div><figure class="snippet picture-snippet fullWidth"><img class="picture-snippet-image" src="gt-figures/1020.png"/><figcaption class="picture-snippet-caption">The Extract example refactoring</figcaption></figure><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>We introduce a new class to hold our examples, and give the example a suitable name.  </p></div><figure class="snippet picture-snippet fullWidth"><img class="picture-snippet-image" src="gt-figures/1021.png"/><figcaption class="picture-snippet-caption">An extracted example method</figcaption></figure><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>Note that the extracted example method has a <code>&lt;gtExample></code> pragma, and unlike a usual test method, it returns an instance.  </p></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <h2> Adding assertions  </h2></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>We now have an example, but we aren't testing anything yet.  </p></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>Rather than directly adding tests to the example method, let's explore first. We expect that a price object should equal another price object with the same money value. We see that this fails.  </p></div><figure class="snippet picture-snippet fullWidth"><img class="picture-snippet-image" src="gt-figures/1022.png"/><figcaption class="picture-snippet-caption">A failing test case</figcaption></figure><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>If we look at the <code>=</code> method and see that it's testing for object identity, not object equality. Let's see what happens if we directly compare the <code>money</code> slots.  </p></div><figure class="snippet picture-snippet fullWidth"><img class="picture-snippet-image" src="gt-figures/1023.png"/><figcaption class="picture-snippet-caption">Comparing money slots</figcaption></figure><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>This passes. We see that Money has implemented <code>=</code>, so we should do the same. We have the code we want right here, so let's extract it as a new <code>=</code> method.  </p></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>    <i>Caveat:    </i> actually there is a bit more work to do to implement a proper <code>=</code> method, but let's skim over this point.  </p></div><figure class="snippet picture-snippet fullWidth"><img class="picture-snippet-image" src="gt-figures/1024.png"/><figcaption class="picture-snippet-caption">Comparing Price equality, not identity</figcaption></figure><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>Now we can go back to the example and rewrite it to add the new assertion.  </p></div><figure class="snippet picture-snippet fullWidth"><img class="picture-snippet-image" src="gt-figures/1025.png"/><figcaption class="picture-snippet-caption">Our assertion as part of the example</figcaption></figure><div class="snippet textual-snippet text-snippet paragraphWidth">  <h2> Price Examples  </h2></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>After a number of iterations we end up with something like this, with a hierarchy of examples covering test cases for prices.  </p></div><figure class="snippet picture-snippet fullWidth"><img class="picture-snippet-image" src="gt-figures/1026.png"/></figure><div class="snippet textual-snippet text-snippet paragraphWidth">  <h2> EDD in a Nutshell  </h2></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>Summing up, instead of starting by writing a test, we first create a     <i>live object    </i> to explore.  </p></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>• Start with an     <i>object    </i>  </p></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>—     <i>Prototype    </i> behavior in the playground  </p></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>—     <i>Extract    </i> methods  </p></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>— Introduce useful     <i>views    </i>  </p></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>•     <i>Extract    </i> examples  </p></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>— Prototype     <i>assertions    </i> in the playground  </p></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>—     <i>Add them    </i> to the example method  </p></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>—     <i>Reuse    </i> examples as setups for new examples  </p></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>We prototype any behavior in the playground of the live object, and then extract methods that work. We create views that explain what is interesting about the object.   </p></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>We extract interesting instances as example methods of a dedicated examples class. We prototype tests in the playground of the live example, before adding them as assertions to an example. We reuse the examples as setups for new examples.  </p></div><div class="snippet textual-snippet text-snippet paragraphWidth">  <p>We iterate until we're done!  </p></div>

                <!-- page content end -->
            </main>
        </div>
    </div>

    <footer class="text-center py-5 le-footer">
        <p class="le-footer-credits">
            Powered by <a class="le-footer-link" href="https://lepiter.com">Lepiter</a> | <a class="le-footer-link" href="https://feenk.com/privacy">Privacy Policy</a>
        </p>
    </footer>

    <!-- scripts -->
    <script type="text/javascript" src="assets/vendor/jquery/js/jquery.js"></script>
    <script type="text/javascript" src="assets/vendor/bootstrap/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="assets/v1/src/js/datefns.min.js"></script>
    <script type="text/javascript" src="assets/v1/src/js/highlight.pack.js"></script>
    <script type="text/javascript" src="assets/v1/src/js/lepiter-common.js"></script>
    <script type="text/javascript" src="assets/v1/src/js/lepiter-snippets.js"></script>
    <script type="text/javascript" src="assets/v1/src/js/lepiter-time.js"></script>
</body>
</html>